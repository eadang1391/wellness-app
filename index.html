<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Wellness App</title>
    
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

    <style>
        :root {
            --sage: #6b8e83;
            --cream: #f4f1de;
            --dark-sage: #4a665e;
            --white: #ffffff;
        }

        body {
            margin: 0;
            padding: 0;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: var(--sage);
            color: var(--dark-sage);
            overflow-x: hidden;
        }

        #app {
            padding: 20px 20px 100px 20px;
            box-sizing: border-box;
            min-height: 100vh;
        }

        header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
            color: var(--cream);
        }

        .logo-section { display: flex; align-items: center; gap: 10px; }
        .logo-img { width: 40px; height: 40px; border-radius: 10px; object-fit: cover; }

        /* Tarjetas estilo Wellness */
        .card {
            background-color: var(--cream);
            border-radius: 18px;
            padding: 20px;
            margin-bottom: 15px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            border: none;
        }

        h2, h3, h4 { margin: 0; }
        input, select {
            width: 100%;
            padding: 14px;
            margin: 8px 0;
            border-radius: 12px;
            border: 1px solid rgba(0,0,0,0.1);
            box-sizing: border-box;
            font-size: 16px;
        }

        button {
            width: 100%;
            padding: 14px;
            border-radius: 12px;
            border: none;
            background-color: var(--dark-sage);
            color: white;
            font-weight: bold;
            font-size: 16px;
            cursor: pointer;
            transition: 0.2s;
            margin-top: 10px;
        }

        button:active { transform: scale(0.97); }

        .btn-outline { background: transparent; border: 1px solid var(--cream); color: var(--cream); width: auto; padding: 6px 12px; }

        /* Navegaci칩n Inferior */
        .nav-bar {
            position: fixed;
            bottom: 0; left: 0; right: 0;
            background-color: var(--dark-sage);
            height: 75px;
            display: flex;
            justify-content: space-around;
            align-items: center;
            border-radius: 25px 25px 0 0;
            z-index: 1000;
        }

        .nav-item { color: var(--cream); text-align: center; font-size: 11px; cursor: pointer; text-decoration: none; }
        .nav-item span { font-size: 22px; display: block; margin-bottom: 2px; }

        .hidden { display: none !important; }

        /* Modales */
        .modal {
            display: none;
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.7);
            z-index: 2000;
            justify-content: center;
            align-items: center;
        }

        .modal-content { background: var(--cream); padding: 25px; border-radius: 20px; width: 85%; max-width: 400px; text-align: center; }

        #link-mp {
            display: block; background: #009ee3; color: white; padding: 15px;
            border-radius: 12px; text-decoration: none; font-weight: bold; margin-top: 15px;
        }
    </style>
</head>
<body>

<div id="app">
    <header>
        <div class="logo-section">
            <img src="logo.png" class="logo-img" onerror="this.onerror=null; this.src='https://cdn-icons-png.flaticon.com/512/3048/3048398.png';">
            <h2>Wellness App</h2>
        </div>
        <button id="btn-logout" class="hidden btn-outline">Salir</button>
    </header>

    <div id="view-auth">
        <div class="card">
            <h3>Bienvenido</h3>
            <p style="font-size: 14px; color: var(--sage);">Inicia sesi칩n para continuar</p>
            <input type="email" id="email" placeholder="Correo electr칩nico">
            <input type="password" id="password" placeholder="Contrase침a">
            <select id="role-select">
                <option value="alumno">Soy Alumno</option>
                <option value="maestro">Soy Maestro</option>
            </select>
            <button id="btn-login">Entrar</button>
            <button id="btn-register" style="background: var(--sage); color: white;">Crear Cuenta</button>
        </div>
    </div>

    <div id="view-alumno" class="view hidden">
        <h3 style="color:var(--cream); margin-bottom:15px;">Clases para ti</h3>
        <div id="list-alumno"></div>
    </div>

    <div id="view-maestro" class="view hidden">
        <div style="display:flex; justify-content:space-between; align-items:center; color:white; margin-bottom:15px;">
            <h3>Mis Clases</h3>
            <button onclick="document.getElementById('modal-crear').style.display='flex'" style="width:auto; margin:0; padding:8px 15px;">+ Crear</button>
        </div>
        <div id="list-maestro"></div>
    </div>

    <div id="view-admin" class="view hidden">
        <h3 style="color:var(--cream); margin-bottom:15px;">Panel Admin</h3>
        <div class="card">
            <h4>Promover Admin</h4>
            <input type="email" id="search-admin" placeholder="Correo del usuario">
            <button id="btn-make-admin">Dar Permisos Admin</button>
        </div>
        <div id="list-admin-users"></div>
    </div>

    <nav id="nav-bottom" class="nav-bar hidden">
        <div class="nav-item" onclick="changeTab('clases')"><span>游</span>Clases</div>
        <div class="nav-item" onclick="changeTab('perfil')"><span>游녻</span>Perfil</div>
        <div id="nav-admin" class="nav-item hidden" onclick="changeTab('admin')"><span>游댏</span>Admin</div>
    </nav>
</div>

<div id="modal-crear" class="modal">
    <div class="modal-content">
        <h3>Nueva Clase</h3>
        <input type="text" id="new-name" placeholder="Nombre de la clase">
        <input type="number" id="new-price" placeholder="Precio MXN">
        <button id="btn-save-class">Publicar Clase</button>
        <button onclick="document.getElementById('modal-crear').style.display='none'" style="background:none; color:gray;">Cancelar</button>
    </div>
</div>

<div id="modal-pago" class="modal">
    <div class="modal-content">
        <h3 id="pago-nombre">Nombre Clase</h3>
        <p id="pago-monto" style="font-weight:bold; color:var(--sage)"></p>
        <a id="link-mp" href="#" target="_blank">PAGAR AHORA</a>
        <button onclick="document.getElementById('modal-pago').style.display='none'" style="background:none; color:gray; margin-top:10px;">Cerrar</button>
    </div>
</div>

<script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
    import { getAuth, createUserWithEmailAndPassword, signInWithEmailAndPassword, onAuthStateChanged, signOut } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";
    import { getFirestore, doc, setDoc, getDoc, collection, addDoc, query, where, onSnapshot, getDocs } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

    // 1. CONFIGURACI칍N FIREBASE
    const firebaseConfig = {
  apiKey: "AIzaSyB7NWc1AIHs9UN73-3YtUFECcXDse2JdJo",
  authDomain: "escarola-wellness.firebaseapp.com",
  projectId: "escarola-wellness",
  storageBucket: "escarola-wellness.firebasestorage.app",
  messagingSenderId: "212255082736",
  appId: "1:212255082736:web:66d144fa90308578b75a35"
};

    // 2. LINK MERCADO PAGO
    const MP_LINK = "
